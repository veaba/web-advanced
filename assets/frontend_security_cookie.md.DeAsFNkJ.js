import{_ as e,c as i,o as a,aa as s}from"./chunks/framework.qnqjiyko.js";const k=JSON.parse('{"title":"Cookie","description":"","frontmatter":{},"headers":[],"relativePath":"frontend/security/cookie.md","filePath":"frontend/security/cookie.md"}'),o={name:"frontend/security/cookie.md"};function d(l,t,h,r,n,c){return a(),i("div",null,t[0]||(t[0]=[s('<h1 id="cookie" tabindex="-1">Cookie <a class="header-anchor" href="#cookie" aria-label="Permalink to &quot;Cookie&quot;">​</a></h1><p>有关 Cookie 安全的问题</p><p>有关 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" rel="noreferrer">SameSite</a> 问题</p><h2 id="samesite" tabindex="-1">SameSite <a class="header-anchor" href="#samesite" aria-label="Permalink to &quot;SameSite&quot;">​</a></h2><p>三个属性：</p><ul><li><p><code>Strict</code> (严格)</p></li><li><p><code>Lax</code> (松懈)</p></li><li><p><code>None</code> (无)</p></li></ul><h3 id="strict" tabindex="-1"><code>Strict</code> <a class="header-anchor" href="#strict" aria-label="Permalink to &quot;`Strict`&quot;">​</a></h3><p>将完全禁止第三方 <code>Cookie</code>，跨站点时候，不会发送 <code>Cookie</code>，只有当前网页 URL 与请求目标一致时才会带上 <code>Cookie</code>。</p><p>也就是 <strong><code>同站检查</code></strong> 的意思。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Set-cookie:CookieName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=CookieValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; SameSite</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Strict</span></span></code></pre></div><p>这个 <code>Strict</code> 过于严格，导致很多子链接跳转都被不带 <code>cookie</code></p><h3 id="lax" tabindex="-1"><code>Lax</code> <a class="header-anchor" href="#lax" aria-label="Permalink to &quot;`Lax`&quot;">​</a></h3><p>大多数是否，不发送第三方 <code>Cookie</code>，除了导航到目标网站的 <code>Get</code> 请求。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Set-cookie:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CName=CValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; SameSite</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Lax</span></span></code></pre></div><p>导航到目标的 <code>Get</code> 请求，有三种情况，a 链接，预加载，get 表单。</p><table tabindex="0"><thead><tr><th>请求类型</th><th>实例</th><th>正常情况</th><th>Lax</th></tr></thead><tbody><tr><td>a 标签连接</td><td><code>&lt;a href=&quot;&quot;&gt;...&lt;/a&gt;</code></td><td>发送</td><td>发送</td></tr><tr><td>预加载</td><td><code>&lt;link rel=&quot;prefetch&quot; href=&quot;&quot;&gt;/</code></td><td>发送</td><td>发送</td></tr><tr><td>GET 表单</td><td><code>from method=&quot;GET&quot; actions=&quot;&quot;&gt;...&lt;/from&gt;</code></td><td>发送</td><td>发送</td></tr><tr><td>POST 表单</td><td><code>from method=&quot;POST&quot; actions=&quot;&quot;&gt;...&lt;/from&gt;</code></td><td>发送</td><td>不发送</td></tr><tr><td>iframe</td><td><code>&lt;iframe src=&quot;&quot;&gt;&lt;/iframe&gt;</code></td><td>发送</td><td>不发送</td></tr><tr><td>AJAX</td><td><code>$.get(...)</code></td><td>发送</td><td>不发送</td></tr><tr><td>Image</td><td><code>&lt;img src=&quot;&quot;</code></td><td>发送</td><td>不发送</td></tr><tr><td>Svg</td><td><code>&lt;svg src=&quot;&quot;</code></td><td>（未知）</td><td>（未知）</td></tr></tbody></table><p><code>Lax</code> 或 <code>Strict</code> 基本杜绝 <code>CSRF</code> 攻击</p><h3 id="none" tabindex="-1">None <a class="header-anchor" href="#none" aria-label="Permalink to &quot;None&quot;">​</a></h3><p>无效设置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Set-Cookie:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;SameSite</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">None</span></span></code></pre></div><p>有效的设置，即 Cookie 只能通过 HTTPS 协议发送。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Set-Cookie:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;SameSite</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Secure</span></span></code></pre></div><h2 id="引用" tabindex="-1">引用 <a class="header-anchor" href="#引用" aria-label="Permalink to &quot;引用&quot;">​</a></h2><ul><li><a href="http://www.ruanyifeng.com/blog/2019/09/cookie-samesite.html" target="_blank" rel="noreferrer">阮一峰：Cookie 的 SameSite 属性</a></li></ul>',24)]))}const g=e(o,[["render",d]]);export{k as __pageData,g as default};
